,LongestCorrectStreak = max(rle(x)$lengths[rle(x)$values==1])
,CurrentWrongStreak   = rle(x)$lengths[rle(x)$values==0][length(rle(x)$lengths[rle(x)$values==0])]
,CurrentCorrectStreak = rle(x)$lengths[rle(x)$values==1][length(rle(x)$lengths[rle(x)$values==1])]
)
Test %>%
group_by(Group) %>%
summarise(LongestWrongStreak    = max(rle(x)$lengths[rle(x)$values==0])
,LongestCorrectStreak = max(rle(x)$lengths[rle(x)$values==1])
,CurrentWrongStreak   = rle(x)$lengths[rle(x)$values==0][length(rle(x)$lengths[rle(x)$values==0])]
,CurrentCorrectStreak = rle(x)$lengths[rle(x)$values==1][length(rle(x)$lengths[rle(x)$values==1])]
)
TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
)
TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
,CurrentWrongStreak   = rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])]
)
TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
,CurrentWrongStreak   = rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])]
,CurrentCorrectStreak = rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])]
)
View(RawJeopardyData)
View(TidyJeopardyData)
rle(x)$lengths[rle(x)$values==0]
rle(x)$values
rle(x)$values[length(rle(x)$values)]
TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
,CurrentWrongStreak   = rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])]
,CurrentCorrectStreak = ifelse(rle(CorrectAnswer)$values[length(rle(CorrectAnswer)$values)]==1 ,rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])] ,0)
)
TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
,CurrentWrongStreak   = ifelse(rle(CorrectAnswer)$values[length(rle(CorrectAnswer)$values)]==0 ,rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])] ,0)
,CurrentCorrectStreak = ifelse(rle(CorrectAnswer)$values[length(rle(CorrectAnswer)$values)]==1 ,rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])] ,0)
)
LongestWrongStreakChart
StreakData <- TidyJeopardyData %>%
filter(!is.na(CorrectAnswer)) %>%
group_by(Player) %>%
summarise(LongestWrongStreak    = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])
,LongestCorrectStreak = max(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])
,CurrentWrongStreak   = ifelse(rle(CorrectAnswer)$values[length(rle(CorrectAnswer)$values)]==0 ,rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==0])] ,0)
,CurrentCorrectStreak = ifelse(rle(CorrectAnswer)$values[length(rle(CorrectAnswer)$values)]==1 ,rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1][length(rle(CorrectAnswer)$lengths[rle(CorrectAnswer)$values==1])] ,0)
)
StreakData
StreakData %>%
gather(key = "StreakType" ,value = "Streak")
StreakData
StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player)
StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player) %>%
mutate(CorrectFlag = ifelse(str_detect(StreakType ,pattern = "Correct") ,"Correct" ,"Incorrect")
,StreakType = ifelse(str_detect(StreakType ,pattern = "Longest") ,"Longest" ,"Current")
)
StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player)
StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player) %>%
mutate(CorrectFlag = ifelse(str_detect(StreakType ,pattern = "Correct") ,"Correct" ,"Incorrect")
,LengthType = ifelse(str_detect(StreakType ,pattern = "Longest") ,"Longest" ,"Current")
)
StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player) %>%
mutate(CorrectFlag = ifelse(str_detect(StreakType ,pattern = "Correct") ,"Correct" ,"Incorrect")
,LengthType = ifelse(str_detect(StreakType ,pattern = "Longest") ,"Longest" ,"Current")
) %>%
select(Player:StreakType ,CorrectFlag:LengthType ,Streak)
StreakChartData <- StreakData %>%
gather(key = "StreakType" ,value = "Streak" ,-Player) %>%
mutate(CorrectFlag = ifelse(str_detect(StreakType ,pattern = "Correct") ,"Correct" ,"Incorrect")
,LengthType = ifelse(str_detect(StreakType ,pattern = "Longest") ,"Longest" ,"Current")
) %>%
select(Player:StreakType ,CorrectFlag:LengthType ,Streak)
StreakChartData
ggplot(StreakChartData %>% filter(CorrectFlag == "Incorrect") ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData  ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(. ~ LengthType + CorrectFlag) +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData  ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(. ~ LengthType + CorrectFlag) +
# facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData  ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(. ~ LengthType + CorrectFlag ,rows = 2) +
# facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData  ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData  ,aes(x = reorder(Player ,Streak ,function(x) {x}) ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
StreakChartData
ggplot(StreakChartData %>% filter(CorrectFlag == "Incorrect") ,aes(x = reorder(Player ,Streak ,function(x) {x}) ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData %>% filter(CorrectFlag == "Incorrect") ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
?factor
StreakChartData
factor(StreakChartData$LengthType ,levels = c("Longest" ,"Current"))
StreakChartData$LengthType <- factor(StreakChartData$LengthType ,levels = c("Longest" ,"Current"))
ggplot(StreakChartData %>% filter(CorrectFlag == "Incorrect") ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
IncorrectStreakData <- StreakChartData %>%
filter(CorrectFlag == "Incorrect")
IncorrectStreakData %>%
filter(LengthType == "Longest")
IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak))
IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(desc(MaxStreak))
IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(desc(MaxStreak)) %>%
select(Player) %>%
pull()
IncorrectPlayerLevels <- IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(desc(MaxStreak)) %>%
select(Player) %>%
pull()
IncorrectStreakData$Player <- factor(IncorrectStreakData$Player ,levels = IncorrectPlayerLevels)
ggplot(IncorrectStreakData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
IncorrectPlayerLevels <- IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(MaxStreak) %>%
select(Player) %>%
pull()
IncorrectStreakData$Player <- factor(IncorrectStreakData$Player ,levels = IncorrectPlayerLevels)
ggplot(IncorrectStreakData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
StreakData
StreakChartData
ggplot(StreakChartData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(CorrectFlag ~ LengthType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(CorrectFlag ~ LengthType ,scales = "free_x") +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
i <- data.frame(
nbr =c(15.18 ,11.53 ,13.37 ,9.2, 10.9, 12.23 ,9.53, 9.81, 7.86, 12.79,
22.03 ,17.64 ,18.1, 16.78 ,17.53 ,16.97 ,17.76 ,18.35 ,12.82 ,20.91,
22.09 ,19.18 ,17.54 ,18.45 ,19.83 ,16.99 ,19.69 ,19.45 ,13.07 ,21.41,
12.13 ,9.76, 10.79 ,10.74 ,12.43 ,9.65, 12.18 ,11.63 ,6.74, 12.31,
17.5, 14.75 ,15.2, 13.89 ,15.24 ,17.43 ,15.22 ,14.04,9.49, 15.86,
8.09, 5.86, 6.68, 7.34, 8.01, 6.35, 8.4, 7.4, 3.88, 6.92 ),
x2=rep(c("a",  "b",   "c",  "d", "e", "f", "g", "h", "i", "j"),6),
s = c(rep(c(rep(c("3"),10),
rep(c("4"),10),
rep(c("5"),10),
rep(c("6"),10),
rep(c("7"),10),
rep(c("8"),10)),1)))
View(i)
scale_x_reordered <- function(..., sep = "___") {
reg <- paste0(sep, ".+$")
ggplot2::scale_x_discrete(labels = function(x) gsub(reg, "", x), ...)
}
reorder_within <- function(x, by, within, fun = mean, sep = "___", ...) {
new_x <- paste(x, within, sep = sep)
stats::reorder(new_x, by, FUN = fun)
}
ggplot(ii, aes(reorder_within(sn, nbr, s), nbr)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ s, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
i[order(i$s, i$nbr ), ]
ii <- i[order(i$s, i$nbr ), ]
sn <- factor(x = 1:60, labels = ii$x2)
ii$sn <- sn
ii
i <- data.frame(
nbr =c(15.18 ,11.53 ,13.37 ,9.2, 10.9, 12.23 ,9.53, 9.81, 7.86, 12.79,
22.03 ,17.64 ,18.1, 16.78 ,17.53 ,16.97 ,17.76 ,18.35 ,12.82 ,20.91,
22.09 ,19.18 ,17.54 ,18.45 ,19.83 ,16.99 ,19.69 ,19.45 ,13.07 ,21.41,
12.13 ,9.76, 10.79 ,10.74 ,12.43 ,9.65, 12.18 ,11.63 ,6.74, 12.31,
17.5, 14.75 ,15.2, 13.89 ,15.24 ,17.43 ,15.22 ,14.04,9.49, 15.86,
8.09, 5.86, 6.68, 7.34, 8.01, 6.35, 8.4, 7.4, 3.88, 6.92 ),
x2=rep(c("a",  "b",   "c",  "d", "e", "f", "g", "h", "i", "j"),6),
s = c(rep(c(rep(c("3"),10),
rep(c("4"),10),
rep(c("5"),10),
rep(c("6"),10),
rep(c("7"),10),
rep(c("8"),10)),1)))
ii <- i[order(i$s, i$nbr ), ]
sn <- factor(x = 1:60, labels = ii$x2)
ii$sn <- sn
scale_x_reordered <- function(..., sep = "___") {
reg <- paste0(sep, ".+$")
ggplot2::scale_x_discrete(labels = function(x) gsub(reg, "", x), ...)
}
reorder_within <- function(x, by, within, fun = mean, sep = "___", ...) {
new_x <- paste(x, within, sep = sep)
stats::reorder(new_x, by, FUN = fun)
}
ggplot(ii, aes(reorder_within(sn, nbr, s), nbr)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ s, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
ii
sn
StreakChartData
i[order(i$s, i$nbr ), ]
i
i[order(i$s, i$nbr ), ] %>% head()
StreakChartData
i[order(i$s, i$nbr ), ] %>% head()
StreakChartData2 <- StreakChartData %>%
arrange(StreakType ,Streak)
sn <- factor(x = 1:60, labels = ii$x2)
ii$x2
length(StreakChartData2)
count(StreakChartData2)
seq(from = 1 ,to = count(StreakChartData2) ,by = 1)
count(StreakChartData2)
seq(from = 1 ,to = pull(count(StreakChartData2)) ,by = 1)
SequenceVector <- seq(from = 1 ,to = pull(count(StreakChartData2)) ,by = 1)
FactorVector <-  factor(x=SequenceVector ,labels = StreakChartData2$Player)
ggplot(StreakChartData2, aes(reorder_within(FactorVector, Streak, Player), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ s, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
ggplot(StreakChartData2, aes(reorder_within(FactorVector, Streak, Player), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ Player, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
ggplot(StreakChartData2, aes(reorder_within(FactorVector, Streak, Player), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
StreakChartData2 <- StreakChartData2 %>%
mutate(StreakType2 = FactorVector)
StreakChartData2 <- StreakChartData %>%
arrange(StreakType ,Streak)
SequenceVector <- seq(from = 1 ,to = pull(count(StreakChartData2)) ,by = 1)
FactorVector <-  factor(x=SequenceVector ,labels = StreakChartData2$Player)
StreakChartData2 <- StreakChartData2 %>%
mutate(StreakType2 = FactorVector)
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_col() +
coord_flip() +
facet_wrap(. ~ StreakType) +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = "identity")
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = "identity") +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x")
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = "identity") +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x") +
coord_flip()
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = "identity") +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x")
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
scale_y_reordered <- function(..., sep = "___") {
reg <- paste0(sep, ".+$")
ggplot2::scale_y_discrete(labels = function(x) gsub(reg, "", x), ...)
}
ggplot(StreakChartData2, aes(Streak ,reorder_within(StreakType2, Streak, StreakType))) +
geom_bar(stat = "identity") +
scale_y_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_y")
ggplot(StreakChartData2, aes(reorder_within(StreakType2, Streak, StreakType), Streak)) +
geom_bar(stat = 'identity') +
scale_x_reordered() +
facet_wrap(.~ StreakType, ncol=2,scales = "free_x") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=.5,colour='gray50'))
reorder_within(StreakType2, Streak, StreakType)
CorrectStreakData <- StreakChartData %>%
filter(CorrectFlag == "Correct")
CorrectPlayerLevels <- CorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(MaxStreak) %>%
select(Player) %>%
pull()
CorrectStreakData$Player <- factor(CorrectStreakData$Player ,levels = CorrectPlayerLevels)
renderPlot({
ggplot(CorrectStreakData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(CorrectFlag ~ LengthType ,scales = "free_x") +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
})
CorrectStreakData <- StreakChartData %>%
filter(CorrectFlag == "Correct")
CorrectPlayerLevels <- CorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(MaxStreak) %>%
select(Player) %>%
pull()
CorrectStreakData$Player <- factor(CorrectStreakData$Player ,levels = CorrectPlayerLevels)
ggplot(CorrectStreakData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(CorrectFlag ~ LengthType ,scales = "free_x") +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
IncorrectStreakData <- StreakChartData %>%
filter(CorrectFlag == "Incorrect")
IncorrectPlayerLevels <- IncorrectStreakData %>%
filter(LengthType == "Longest") %>%
group_by(Player) %>%
summarise(MaxStreak = max(Streak)) %>%
arrange(MaxStreak) %>%
select(Player) %>%
pull()
IncorrectStreakData$Player <- factor(IncorrectStreakData$Player ,levels = IncorrectPlayerLevels)
ggplot(IncorrectStreakData ,aes(x = Player ,y = Streak)) +
geom_col() +
coord_flip() +
facet_grid(CorrectFlag ~ LengthType ,scales = "free_x") +
scale_y_continuous(labels = comma ,breaks = pretty_breaks()) +
# ggtitle("Points by Player") +
# theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Player") +
# scale_fill_gradientn(colors = c("darkred", "tomato1","palegreen", "darkgreen") ,limit = c(MinTeammatePlusMinus ,MaxTeammatePlusMinus)) +
# scale_fill_brewer(palette = "Set1") +
theme_fivethirtyeight()
